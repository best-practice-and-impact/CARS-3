---
title: "Summary statistics"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: 
      collapsed: false
---

```{r global-options, include=FALSE}
# Set echo=FALSE for all chunks
knitr::opts_chunk$set(echo=FALSE)

library(magrittr)

tables <- carsurvey3::summarise_all(data)

```

This is a draft document. 

Please note all data presented here are provisional and intended only for feedback purposes. It is possible that the figures presented here will change in future. 

# Coding frequency and tools

## Most respondents use code at least regularly in their current role

Over half of respondents reported using code to achieve their work objectives regularly or all the time. This survey is likely to have attracted many analysts with an interest in programming. Nevertheless, the figures here show that for many government analysts programming has become a key tool in their work. 


```{r}
plot <- carsurvey2::plot_freqs(tables$code_freq, "Coding frequency", "Count", n = samples$all, font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$code_freq)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("coding-freq", plot, table)

```

## Respondents use code to preform a variety of data operations 

the majority of respondents use code to perform each of the data operations included in the survey, at least in part. While these were the responses to the questions included, many respondents reported other data operations in the free text box provided. Code is currently being used in government at every stage of analysis pipelines, from pre-processing through to analysis and presentation. 


```{r}
plot <- carsurvey2::plot_stacked(tables$operations, "Count", "Data operation", n = samples$all, font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$operations)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("operations", plot, table)
```


## Access to and knowledge of programming languages

Given a list of programming tools, we asked respondents to answer “Yes”, “No” or “Don’t know” for the following statements;

* This tool is available to use for my work.
* I know how to program with this tool to a level suitable for my work. 

Please note we did not set precise definitions for availability and knowledge here, as these are dependent on individual circumstances. 


## Open source tools are the most available for analysts work

R, SQL and Python were the three most available programming languages to government analysts. All three are open source languages, the use of which is a key component of the [RAP methodology](https://gss.civilservice.gov.uk/reproducible-analytical-pipelines/). Such tools help analysts make their work more transparent and reproducible to their users, as cost is not a barrier to use. 

```{r}
plot <- carsurvey2::plot_stacked(tables$access, xlab = "Count", ylab = "Programming tool", n = samples$all, colour_scale = "3scale", font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$access, row.names = FALSE)) %>%  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("tools-access", plot, table)
```

## Capability is most common in open source tools

More respondents said they were able to carry out their work using Python, SQL and R, showing open source tools also lead the way in capability. 

```{r}
plot <- carsurvey2::plot_stacked(tables$knowledge, xlab = "Count", ylab = "Programming tool", n = samples$all, colour_scale = "3scale", font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$knowledge, row.names = FALSE)) %>%  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("tools-knowledge", plot, table)
```

## Access and knowledge gaps

Using data collected from previous questions we calculated the number of respondents who have access but no knowledge, access and knowledge, and knowledge but no access for each programming language. 

## Many respondents have capability in tools they cannot access in work

A large minority respondents have capability in programming languages they do not have access to. This is particularly true for proprietary software. A further advantage of open source software is that it is easier for analysts' coding skills to be transferrable if they learn an open source language, as they are more likely to have access to the same software at another department in future. 

```{r}

plot <- carsurvey2::plot_stacked(tables$language_status, colour_scale = "3scale", xlab = "Count", ylab = "Programming tool", n = samples$all, font_size = 14, width = 700)

table <- kableExtra::kable_styling(knitr::kable(tables$language_status, row.names = FALSE)) %>%
  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("tools-status", plot, table)

```


# Coding capability

## Most analysts report their coding ability has improved during current role

Capability appears to be increasing as majority of respondents said their coding skill are slightly better or significantly better during current role. However, the data also indicate the need to maintain existing capability. A large minority of respondents reported a decline in their coding ability, suggesting more work is needed to ensure analysts spend enough time maintaining these skills.

This question was only asked of respondents with coding experience outside of their current role. 


``` {r}
plot <- carsurvey2::plot_freqs(tables$ability_change, xlab = "Change in ability", ylab = "Count", n = samples$code_outside_current_role, break_q_names_col = "Ability Change", font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$ability_change, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$code_outside_current_role))

carsurvey2::wrap_outputs("ability", plot, table)

```

## Most respondents learned to code outside of the public sector

Analysts are generally learning to code for the first time before joining the public sector, particularly in education. 

This survey was for government analysts only and so public sector frequency is a combination of “In public sector employment” and “In current role”. 


``` {r}

plot <- carsurvey2::plot_freqs(tables$where_learned, xlab = "", ylab = "Count", n = samples$any_code_experience, break_q_names_col = "First coding experience", orientation = "h", font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$where_learned, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$any_code_experience))

carsurvey2::wrap_outputs("first-learn", plot, table)

```


# Coding practices


## Many coding practices are not regularly applied in analysts work

Practices such as version control, AQUA guidance, unit testing and open sourcing code are fundamental to the minimum viable produce (MVP) for RAP. These practices are not regularly done which means respondents are not regularly meeting RAP MVP. 

These practices are important as they make our code more reproducible, auditable and assured. More information can be found out about RAP and the minimum viable product in the quality assurance of code for analysis and research.


```{r}
plot <- carsurvey2::plot_likert(tables$coding_practices, 5, "Frequency", "", n = samples$coders, neutral_mid = FALSE, font_size = 14, height = 1000, width = 700, break_q_names_col = "Question", max_lines = 3)

table <- kableExtra::kable_styling(carsurvey2::output_likert_table(tables$coding_practices)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("code-prac", plot, table)

```


## Most types of documentation are not regularly used.

Over 50% of respondents use code comments regularly or more, other types of documentation are not regularly used. 

Embedded documentation is one of the components which make up a RAP minimum viable product. Documentation is important to help others be clear on what the code is doing. To find out more about documents check the Quality assurance of code for analysis and research book.



```{r}
plot <- carsurvey2::plot_likert(tables$doc, 5, "Frequency", "", n = samples$coders, neutral_mid = FALSE, font_size = 14, height = 700, width = 700, break_q_names_col = "Question")

table <- kableExtra::kable_styling(carsurvey2::output_likert_table(tables$doc)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("doc", plot, table)

```

## Not many respondents are using dependency management or reproducible workflow packages

The environment that your code runs in includes the machine, the operating system, the programming language, and any external packages. It is important to record this information to ensure reproducibility. Reproducibility is important as it allows analysts to prove the result.

For user ease these questions cover a range of topics which in previous years were spread out over multiple questions. We condensed them into two questions as most the responses were “No” or “I don’t know what this is”. 


```{r}

plot <- carsurvey2::plot_freqs(tables$dependency_management, xlab = "Use dependency management software", ylab = "count", n = samples$coders, break_q_names_col = "Use dependency management software", font_size = 14, width = 600)


table <- kableExtra::kable_styling(knitr::kable(tables$dependency_management)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("dep_management", plot, table)

```


## Reproducible workflow packages


```{r}

plot <- carsurvey2::plot_freqs(tables$rep_workflow, xlab = "Use reproducible workflows packages", ylab = "count", n = samples$coders, break_q_names_col = "Use reproducible workflow packages", font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$rep_workflow)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("workflow", plot, table)

```


# RAP knowledge and opinions

# Knowledge of RAP

```{r}
plot <- carsurvey2::plot_freqs(tables$rap_knowledge, "", "Count", n = samples$all, font_size = 14, orientation = "h", break_q_names_col = "RAP champion knowledge", max_lines = 3, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$rap_knowledge, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$all))

carsurvey2::wrap_outputs("rap-knowledge", plot, table)

```


## Opinions on RAP

```{r}
plot <- carsurvey2::plot_likert(tables$rap_opinions, 3, "Frequency", "", n = samples$heard_of_rap, font_size = 14, height = 700, width = 700, break_q_names_col = "Question")

table <- kableExtra::kable_styling(carsurvey2::output_likert_table(tables$rap_opinions)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$heard_of_rap))

carsurvey2::wrap_outputs("rap-opinions", plot, table)

```


# RAP scores

## RAP components

```{r}
plot <- carsurvey2::plot_grouped(tables$rap_components, "", "Count", n = samples$coders, orientation = "h", font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$rap_components, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("rap_comps", plot, table)

```


## Basic RAP scores

```{r}

bar_colour <- carsurvey2::get_2colour_scale(2)[2][[1]]
bar_colour <- rgb(bar_colour[1],bar_colour[2],bar_colour[3], maxColorValue = 255)

plot <- carsurvey2::plot_freqs(tables$basic_rap_scores, "Basic RAP score", "Count", bar_colour = bar_colour, n = samples$coders, font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$basic_rap_scores, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("basic_score", plot, table)

```


## Advanced RAP scores

```{r}

plot <- carsurvey2::plot_freqs(tables$advanced_rap_scores, "Advanced RAP score", "Count", n = samples$coders, font_size = 14, width = 600)

table <- kableExtra::kable_styling(knitr::kable(tables$advanced_rap_scores, row.names = FALSE)) %>% 
  kableExtra::add_footnote(paste0("Sample size = ", samples$coders))

carsurvey2::wrap_outputs("advanced_score", plot, table)

```
